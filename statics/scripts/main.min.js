var $jscomp={scope:{}};$jscomp.defineProperty="function"==typeof Object.defineProperties?Object.defineProperty:function(a,c,b){if(b.get||b.set)throw new TypeError("ES3 does not support getters and setters.");a!=Array.prototype&&a!=Object.prototype&&(a[c]=b.value)};$jscomp.getGlobal=function(a){return"undefined"!=typeof window&&window===a?a:"undefined"!=typeof global&&null!=global?global:a};$jscomp.global=$jscomp.getGlobal(this);$jscomp.SYMBOL_PREFIX="jscomp_symbol_";
$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};$jscomp.symbolCounter_=0;$jscomp.Symbol=function(a){return $jscomp.SYMBOL_PREFIX+(a||"")+$jscomp.symbolCounter_++};
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var a=$jscomp.global.Symbol.iterator;a||(a=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("iterator"));"function"!=typeof Array.prototype[a]&&$jscomp.defineProperty(Array.prototype,a,{configurable:!0,writable:!0,value:function(){return $jscomp.arrayIterator(this)}});$jscomp.initSymbolIterator=function(){}};$jscomp.arrayIterator=function(a){var c=0;return $jscomp.iteratorPrototype(function(){return c<a.length?{done:!1,value:a[c++]}:{done:!0}})};
$jscomp.iteratorPrototype=function(a){$jscomp.initSymbolIterator();a={next:a};a[$jscomp.global.Symbol.iterator]=function(){return this};return a};$jscomp.polyfill=function(a,c,b,d){if(c){b=$jscomp.global;a=a.split(".");for(d=0;d<a.length-1;d++){var f=a[d];f in b||(b[f]={});b=b[f]}a=a[a.length-1];d=b[a];c=c(d);c!=d&&null!=c&&$jscomp.defineProperty(b,a,{configurable:!0,writable:!0,value:c})}};
$jscomp.polyfill("Array.from",function(a){return a?a:function(a,b,d){$jscomp.initSymbolIterator();b=null!=b?b:function(a){return a};var c=[],g=a[Symbol.iterator];if("function"==typeof g)for(a=g.call(a);!(g=a.next()).done;)c.push(b.call(d,g.value));else for(var g=a.length,e=0;e<g;e++)c.push(b.call(d,a[e]));return c}},"es6-impl","es3");$jscomp.array=$jscomp.array||{};
$jscomp.iteratorFromArray=function(a,c){$jscomp.initSymbolIterator();a instanceof String&&(a+="");var b=0,d={next:function(){if(b<a.length){var f=b++;return{value:c(f,a[f]),done:!1}}d.next=function(){return{done:!0,value:void 0}};return d.next()}};d[Symbol.iterator]=function(){return d};return d};$jscomp.polyfill("Array.prototype.keys",function(a){return a?a:function(){return $jscomp.iteratorFromArray(this,function(a){return a})}},"es6-impl","es3");
var runLoading=function(a){a.style.display="block";a.innerHTML="Loading";return setInterval(function(){return a.innerHTML+="."},1E3)},stopLoading=function(a,c){clearInterval(a);c.style.display="none";c.innerHTML=""},processCandidate=function(a){ret=[];a.forEach(function(a){insert={};for(var b in a)-1<a[b].indexOf(",")?insert[b]=a[b].split(","):insert[b]=a[b];ret.push(insert)});return ret},toggleButton=function(a){"true"===a.getAttribute("data-selected")?a.removeAttribute("data-selected"):a.setAttribute("data-selected",
"true")},bindButtonBehavior=function(a){a=$("fieldset",a);var c=Array.from($$(".button",a));c.forEach(function(a){a.addEventListener("click",function(a){a.preventDefault();c.map(function(a){return a.removeAttribute("data-selected")});a=getButton(a.target);toggleButton(a)})})},bindButtonLimit=function(a){var c=parseConfig(a);$("fieldset",a);Array.from($$(".button",a)).forEach(function(b){b.addEventListener("click",function(b){b.preventDefault();b=getButton(b.target);toggleButton(b);var d=$$(".button[data-selected=true]",
a);c.upperBound&&d.length>c.upperBound&&(alert("\u5df2\u8d85\u904e\u53ef\u9078\u4e0a\u9650\uff01\u8acb\u5148\u53d6\u6d88\u9078\u64c7\u5176\u4ed6\u9078\u9805\u624d\u53ef\u4ee5\u518d\u9078\u5594\uff01"),toggleButton(b))})})},bindRankLimit=function(a){var c=Array.from($$("input[type=number]",a));c.forEach(function(a){a.setAttribute("max",c.length);a.addEventListener("change",function(a){1>a.target.value||a.target.value>c.length?(alert("\u4e0d\u80fd\u586b\u5165 1~"+c.length+" \u4ee5\u5916\u7684\u6578\u5b57\uff0c\u8acb\u66f4\u6b63\u3002"),
a.target.value=""):1<c.filter(function(b){return b.value===a.target.value}).length&&(alert("\u672c\u984c\u7d44\u5df2\u6709\u6392\u540d\u7b2c "+a.target.value+" \u7684\u9078\u9805\uff0c\u8acb\u66f4\u6b63\u3002"),a.target.value="")})})},initializeView=function(){Array.from($$("fieldset.inline")).forEach(function(a){3===$$(".button",a).length?a.className+=" elements-3":4===$$(".button",a).length?a.className+=" elements-4":5===$$(".button",a).length&&(a.className+=" elements-5")});Array.from($$("#test-render section")).forEach(function(a){var c=
parseConfig(a);c&&("level"===c.type?bindButtonBehavior(a):"choice"===c.type?1===c.upperBound?bindButtonBehavior(a):bindButtonLimit(a):"rank"===c.type&&bindRankLimit(a))})},initializeSubmit=function(a){$("#test form").addEventListener("submit",function(c){c.preventDefault();$("#result").style.display="none";$("#result-render").innerHTML="";var b=Array.from($$("section",c.target));c=!0;for(var d in b){var f=validate(b[d]);if(f){c=!1;alert($("h2",b[d]).innerText+"\u586b\u5beb\u6709\u8aa4\u5594\uff01"+
f+"\u3002");break}}if(c){var g={};b.forEach(function(a){var b=parseConfig(a);b&&"list"===b.type&&"*"!==parseFilled(a)&&(g[b.name]=parseFilled(a))});var e={};a.forEach(function(a){if(a.name){var c=e[a.name]=0;b.forEach(function(b){if(b=calculate(b,a))c+=1,e[a.name]+=b});e[a.name]=100*e[a.name]/c}});d=Object.keys(e).map(function(a){return{name:a,score:e[a]}});d=d.sort(function(a,b){return a.score>b.score?-1:a.score<b.score?1:0});renderResults(d,a,g);$("#result").style.display="block"}})},initializeDisplayNoAnswer=
function(a){$("#test form").addEventListener("submit",function(c){c.preventDefault();var b=$("#no-answer-render");b.innerHTML="";var d={};Array.from($$("section",c.target)).forEach(function(a){var b=parseConfig(a);b&&"list"===b.type&&"*"!==parseFilled(a)&&(d[b.name]=parseFilled(a))});a.forEach(function(a){var c=0<Object.keys(d).length?Object.keys(d).map(function(b){return a[b]===d[b]}).reduce(function(a,b){return a&&b}):!0;a.name&&c&&(b.innerHTML+=remainCandidateTemplate(a))})})},calculate=function(a,
c){var b=parseConfig(a);if(b){var d=parseFilled(a),f=c[a.id];return"level"===b.type?(b=Array.from($$(".button",a)).map(function(a){return a.getAttribute("data-code")}),similarity(b,b[Math.floor(b.length/2)],d,f)):"choice"===b.type?1===b.upperBound?(b=Array.from($$(".button",a)).map(function(a){return a.getAttribute("data-code")}),similarity(b,null,d,f)):overlap(d,f):"rank"===b.type?distance(d,f):null}},renderResults=function(a,c,b){var d=$("#result-render"),f=0;a.forEach(function(a){var e={},g;for(g in c){e.candidate=
c[g];var h=0<Object.keys(b).length?Object.keys(b).map(function(a){return function(c){return a.candidate[c]===b[c]}}(e)).reduce(function(a,b){return a&&b}):!0;e.candidate.name===a.name&&h&&(f+=1,d.innerHTML+=displayCandidateTemplate(f,a.score,e.candidate));e={candidate:e.candidate}}})};
